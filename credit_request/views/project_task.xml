<?xml version="1.0" encoding="utf-8"?>
<odoo>

  <record id="project_task_inherit_credit_request" model="ir.ui.view">
    <field name="name">project.task.inherit.credit.request</field>
    <field name="model">project.task</field>
    <field name="inherit_id" ref="project.view_task_form2"/>
    <field name="arch" type="xml">

        <xpath expr="//button[@name='action_open_parent_task']" position="before">
            <button type="object" name="action_view_lead" class="oe_stat_button" icon="fa-money" attrs="{'invisible': [('lead_id', '=', False)]}" string="Oportunidad"/>
            <field name="lead_id" invisible="1"/>
        </xpath>
        
        <xpath expr="//field[@name='date_deadline']" position="before">
            <field name="request_task" invisible="1"/>
            <field name="attached_document" widget="many2many_binary" attrs="{'invisible': [('request_task', '=', False)]}"/>
        </xpath>
     
    </field>
  </record>

  <!-- VISTA ARBOL PARA PROJECT.TASK DESDE CRM -->

  <record id="project_task_tree_from_crm" model="ir.ui.view">
    <field name="name">project.task.tree.from.crm</field> 
    <field name="model">project.task</field>
    <field name="arch" type="xml">
      <tree>
        <field name="name"/>
        <field name="partner_id"/>
        <field name="project_id"/>
        <field name="user_id"/>
      </tree>
    </field> 
  </record>

    <!-- VISTA FORMULARIO PARA PROJECT.TASK DESDE CRM-->

  <record id="project_task_form_from_crm" model="ir.ui.view"> 
    <field name="name">project.task.from.crm</field> 
    <field name="model">project.task</field>
    <field name="arch" type="xml">
      <form string="Solicitud de crédito">
          <header>
            <field name="stage_id" widget="statusbar"/>
          </header>
          <sheet>
              <group>
                <div class="oe_title">
                  <h1>
                    <field name="name" placeholder="Nombre"/>
                  </h1>
                </div>
              </group>

              <group></group>

              <group>
                <group>
                  <field name="project_id" readonly="1"/>
                  <field name="attached_document" widget="many2many_binary" readonly="1"/>
                </group>
                <group>
                  <field name="partner_id" readonly="1"/>
                  <field name="user_id" readonly="1"/>
                </group>
              </group>
              <group>
                <field name="description"/>
              </group>
          </sheet>
          <div class="oe_chatter">
            <field name="message_follower_ids" widget="mail_followers"/>
            <field name="activity_ids" widget="mail_activity"/>
            <field name="message_ids" widget="mail_thread"/>
          </div>
      </form>
    </field> 
  </record>

  <record id="get_project_task_request_view" model="ir.actions.act_window">
      <field name="name">Solicitudes de crédito</field>
      <field name="type">ir.actions.act_window</field>
      <field name="res_model">project.task</field>
      <field name="view_mode">tree,form</field>
      <field name="view_id" eval="project_task_tree_from_crm"/>
      <field name="help" type="html">
          <p class="o_view_nocontent_smiling_face">
              Crea una nueva Solicitud de crédito
          </p>
      </field>
  </record>

</odoo>
